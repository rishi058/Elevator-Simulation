There are race condition vulnerabilities due to concurrent requests. Here are the critical issues:

ðŸš¨ Critical Race Conditions
1. Non-Thread-Safe Heap Operations
The Elevator class uses heap data structures (up_stops and down_stops) that are accessed by both:

The main run() loop (reading/deleting)
HTTP endpoint handlers via add_request() and add_stop() (writing)

2. State Mutation During Movement
In run(), the elevator checks for closer stops while moving:

3. Direction State Races
The direction field is modified in multiple places without synchronization:

Set in add_stop()
Set in run()
Read in get_effective_direction()

Recommended Solution
Add an asyncio.Lock to protect shared state:


------------------------------------------------------------

I am not able to reproduce these Critical Race Conditions..
Therefore, leaving this to implement in future.